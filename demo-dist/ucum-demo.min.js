!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.demoPkg=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.UcumDemoConfig={defCategories_:["Clinical Use"],categories_:["Nonclinical Use","Obsolete"],categoryValues_:{"Clinical Use":"Clinical","Nonclinical Use":"Nonclinical",Obsolete:"Obsolete"},defDisplayFlds_:["cs_code","name","guidance"],displayFlds_:["category","synonyms","loinc_property","source"],baseSearchURL_:"https://lforms-service.nlm.nih.gov/api/ucum/v1/search",defCols_:["cs_code","name","guidance"],baseSearchOpts_:{nonMatchSuggestions:!1,tableFormat:!0,valueCols:[0]}}},{}],2:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=(c.UcumDemoConfig=a("./demoConfig.js").UcumDemoConfig,c.UcumDemo=a("./ucumDemo.js").UcumDemo);d.getInstance()},{"./demoConfig.js":1,"./ucumDemo.js":3}],3:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=ucumPkg.Ucum,g=a("./demoConfig").UcumDemoConfig,h=ucumPkg.UcumLhcUtils,i=ucumPkg.UnitTables,j=ucumPkg.UcumFileValidator,k=c.UcumDemo=function(){function a(){d(this,a),this.utils_=h.getInstance(),this.utabs_=i.getInstance(),this.urlConvCats_=g.defCategories_,this.urlConvDispFlds_=g.defCols_;var b=this.buildUrlAndOpts("convert");this.fromAuto_=new Def.Autocompleter.Search("convertFrom",b[0],b[1]),this.urlValCats_=g.defCategories_,this.urlValDispFlds_=g.defCols_,b=this.buildUrlAndOpts("validate"),this.valAuto_=new Def.Autocompleter.Search("valString",b[0],b[1]),this.toAuto_=new Def.Autocompleter.Prefetch("convertTo",[]);var e=a.prototype;a=function(){throw new Error("UcumDemo is a Singleton.  Use UcumDemo.getInstance() instead.")},c&&(c.UcumDemo=a),a.prototype=e;var f=this;a.getInstance=function(){return f}}return e(a,[{key:"buildUrlAndOpts",value:function(a){var b=g.baseSearchURL_,c=g.baseSearchOpts_,d="convert"===a?this.urlConvCats_:this.urlValCats_,e="convert"===a?this.urlConvDispFlds_:this.urlValDispFlds_,f=d.length;if(f>0){for(var h="",i=0;i<f;i++)i>0&&(h+=" OR "),h+=g.categoryValues_[d[i]];f>1&&(h="("+h+")"),b+="?q=category:"+h}var j=e.length,k=g.defCols_;if(j>0){k=e;var l="df="+e.join(",");l=f>0?"&"+l:"?"+l,b+=l}return c.colHeaders=k,[b,c]}},{key:"buildAdvancedSettings",value:function(){var a=document.getElementById("advancedSearch"),b=document.createElement("P"),c=document.createTextNode("Limit search to units in selected categories:");b.appendChild(c),a.appendChild(b),this.buildCheckBoxes(a,g.defCategories_,!0,"category"),this.buildCheckBoxes(a,g.categories_,!1,"category");var d=document.createElement("P");d.className="topMargin20";var e=document.createTextNode("Select unit fields to display:");d.appendChild(e),a.appendChild(d),this.buildCheckBoxes(a,g.defDisplayFlds_,!0,"displayField"),this.buildCheckBoxes(a,g.displayFlds_,!1,"displayField")}},{key:"buildCheckBoxes",value:function(a,b,c,d){for(var e=b.length,f=function(e){var f=b[e],g=document.createElement("INPUT");g.setAttribute("type","checkbox"),g.checked=c,g.id=f+"_box",g.value=f,g.setAttribute("class",d),g.setAttribute("style","margin-left: 10px; margin-right: 3px;"),g.addEventListener("click",function(){demoPkg.UcumDemo.getInstance().updateSetting(g.id)}),a.appendChild(g);var h=(document.createElement("span"),document.createTextNode(f));h.className="checkboxText",a.appendChild(h)},g=0;g<e;g++)f(g)}},{key:"updateSetting",value:function(a){var b=document.getElementById(a),c=b.className,d=b.value,e=b.checked;if("category"===c){var f=this.urlConvCats_.indexOf(d);e&&f<0?this.urlConvCats_.push(d):!e&&f>=0&&this.urlConvCats_.splice(f,1)}else{if("displayField"!==c)throw new Error("An error occured while specifying your choice.");var g=this.urlConvDispFlds_.indexOf(d);e&&g<0?this.urlConvDispFlds_.push(d):!e&&g>=0&&this.urlConvDispFlds_.splice(g,1)}var h=this.buildUrlAndOpts("convert");this.fromAuto_.clearCachedResults(),this.fromAuto_.destroy(),this.fromAuto_=new Def.Autocompleter.Search("convertFrom",h[0],h[1])}},{key:"reportUnitStringValidity",value:function(a,b){this.utils_.useHTMLInMessages(!0),this.utils_.useBraceMsgForEachString(!0);var c=document.getElementById(a).value,d=document.getElementById(b);d.innerHTML="";var e=[],f="";if(""===c)e.push("Please specify a unit string to be validated.");else try{var g=this.utils_.getSpecifiedUnit(c);g[0]?f=g[1]+" is a valid unit expression.":0===g[2].length&&(f=g[1]+" is NOT a valid unit expression."),g[2].length>0&&(e=e.concat(g[2]))}catch(a){e.push(a.message)}var h=e.join("<br>");f.length>0&&(h=f+"<br>"+h),d.innerHTML=h}},{key:"convertUnit",value:function(a,b,c,d){this.utils_.useHTMLInMessages(!0),this.utils_.useBraceMsgForEachString(!0),void 0===d&&(d=f.decDigits_);var e=document.getElementById(a).value,g=parseFloat(document.getElementById(b).value),h=e.indexOf(f.codeSep_);h>0&&(e=e.substr(0,h));var i=document.getElementById(c).value,j=i.indexOf(f.codeSep_);j>0&&(i=i.substr(0,j));var k=this.utils_.convertUnitTo(e,g,i,d),l=document.getElementById("resultString");l.innerHTML=k.msg.join("<BR>")}},{key:"getCommensurables",value:function(a,b,c){this.utils_.useHTMLInMessages(!0),this.utils_.useBraceMsgForEachString(!0);var d=document.getElementById(b);d.innerHTML="",this.toAuto_.setList("");var e=document.getElementById(c);e.innerHTML="";var g=document.getElementById(a).value,h=g.indexOf(f.codeSep_);h>0&&(g=g.substr(0,h));var i=[];try{var j=this.utils_.commensurablesList(g),k=j[0],l=(j[1],document.getElementById("convertRight"));if(k){for(var m=k.length,n=[],o=0;o<m;o++)n[o]=k[o].getProperty("csCode_")+f.codeSep_+k[o].getProperty("name_");n.sort(this.utabs_.compareCodes),this.toAuto_.setList(n),l.style.visibility="visible"}else l.style.visibility="hidden"}catch(a){i.push(a.message)}i.length>0&&(e.innerHTML=i.join("<BR>"))}},{key:"toggleDisplay",value:function(a,b,c,d){this.utils_.useHTMLInMessages(!0),this.utils_.useBraceMsgForEachString(!0);var e=document.getElementById(a),f=null;b&&(f=document.getElementById(b)),e&&("none"===e.style.display?(e.style.display="block",f&&(f.innerText=f.innerText.replace(d,c))):(e.style.display="none",f&&(f.innerText=f.innerText.replace(c,d))))}},{key:"fileSelected",value:function(){var a=document.getElementById("colNameDiv");a.setAttribute("style","display:block")}},{key:"columnSpecified",value:function(){var a=document.getElementById("colName").value;this.utils_.useHTMLInMessages(!1),this.utils_.useBraceMsgForEachString(!1);var b=document.getElementById("inputfile"),c=j.getInstance();c.validateFile(b.files[0],a,this.initiateDownload,this.fileValidationError)}},{key:"initiateDownload",value:function(a){function b(){window.removeEventListener("focus",b,!1),URL.revokeObjectURL(a);var c=document.getElementById("downlink");c.parentElement.removeChild(c);var d=document.getElementById("inputfile");d.value=null;var e=document.getElementById("colNameDiv");e.setAttribute("style","display:none")}var c=document.createElement("a");c.id="downlink",c.href=a,c.download="UnitStringValidations.csv",document.body.appendChild(c),window.addEventListener("focus",b,!1),c.click()}},{key:"fileValidationError",value:function(a,b){console.log(a+" error; err = "+b);var c=b+"\n\nSorry - your validation file could not be written.";alert(c);var d=document.getElementById("inputfile");d.value="";var e=document.getElementById("colNameDiv");e.setAttribute("style","display:none")}},{key:"resetFileInput",value:function(){var a=document.getElementById("inputfile");a.value="";var b=document.getElementById("colNameDiv");b.setAttribute("style","display:none")}}]),a}();k.getInstance=function(){return new k},k.getInstance()},{"./demoConfig":1}]},{},[2])(2)});